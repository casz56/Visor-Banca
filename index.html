<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Visor Banca</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<!--
  IMPORTANTE (LOGO):
  ‚úÖ El archivo debe llamarse EXACTAMENTE: Logo_Infihuila.png
  ‚úÖ Debe estar en la MISMA carpeta del index.html
-->

<body class="bg-slate-50 text-slate-900">
  <header class="sticky top-0 z-40 bg-slate-900 text-white border-b border-teal-500/30">
    <div class="max-w-7xl mx-auto px-6 py-5 flex flex-col lg:flex-row items-center justify-between gap-4">

      <!-- IZQUIERDA: LOGO + TITULOS -->
      <div class="flex items-center gap-4">
        <!-- ‚úÖ LOGO INFIHUILA (arriba izquierda) -->
        <div class="flex items-center justify-center bg-white rounded-2xl shadow-lg border border-slate-200 p-2">
          <img
            src="./Logo_Infihuila.png"
            alt="INFIHUILA"
            class="h-12 w-auto object-contain"
            onerror="this.style.display='none'; document.getElementById('logoFallback').style.display='flex';"
          />
          <!-- Fallback si no encuentra la imagen -->
          <div id="logoFallback" style="display:none" class="h-12 px-3 items-center justify-center">
            <span class="text-xs font-black text-slate-700">INFIHUILA</span>
          </div>
        </div>

        <div>
          <h1 class="text-2xl font-black tracking-tighter uppercase leading-none">Visor Institucional</h1>
          <p class="text-teal-300 text-[10px] font-bold tracking-[0.2em] uppercase mt-1">Cifras en millones de pesos</p>
        </div>
      </div>

      <!-- DERECHA: CONTROLES -->
      <div class="flex flex-wrap items-center justify-center lg:justify-end gap-3 w-full lg:w-auto">
        <div class="relative">
          <button id="btnBanks" class="flex items-center gap-2 px-4 py-2.5 rounded-xl text-xs font-black uppercase tracking-widest transition-all border bg-slate-800 border-slate-700 text-slate-200 hover:bg-slate-700">
            Instituciones (<span id="banksCount">0</span>)
            <svg class="w-4 h-4 opacity-80" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>
          </button>

          <div id="banksMenu" class="hidden absolute top-full right-0 mt-2 w-72 bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl overflow-hidden z-50">
            <div class="p-4 border-b border-slate-800 flex justify-between items-center bg-slate-800/50">
              <span class="text-[10px] font-black uppercase tracking-widest text-teal-300">Seleccionar Bancos</span>
              <button id="btnToggleAll" class="text-[9px] font-bold text-slate-400 hover:text-white uppercase underline">Todos</button>
            </div>
            <div id="banksList" class="max-h-72 overflow-y-auto p-2 grid gap-1"></div>
          </div>
        </div>

        <button id="btnExcel" class="flex items-center gap-2 px-5 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl text-[10px] font-black uppercase tracking-wider transition-all active:scale-95">
          Descargar Excel
        </button>

        <button id="btnReset" class="flex items-center gap-2 px-4 py-2.5 bg-slate-800 border border-slate-700 hover:bg-slate-700 text-slate-200 rounded-xl text-xs font-black uppercase tracking-widest transition-all active:scale-95">
          Restablecer
        </button>

        <div class="relative min-w-[200px]">
          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-teal-300 text-xs">üìç</span>
          <select id="selMunicipio" class="w-full bg-slate-800/50 border border-slate-700 rounded-xl pl-10 pr-10 py-2.5 text-sm focus:ring-2 focus:ring-teal-500 appearance-none cursor-pointer text-white"></select>
          <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none">‚ñæ</span>
        </div>

        <div class="relative min-w-[220px]">
          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm">üîé</span>
          <input id="txtSearch" type="text" placeholder="Buscar entidad..." class="w-full bg-slate-800 border border-slate-700 rounded-xl pl-10 pr-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-teal-500 transition-all" />
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-6 py-8 space-y-8">
    <section class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="p-8 rounded-[2.5rem] border shadow-sm bg-indigo-50 border-indigo-100">
        <p class="text-slate-500 text-[10px] font-black uppercase tracking-widest mb-1">Colocaci√≥n Total</p>
        <p id="statTotalCol" class="text-3xl font-black text-slate-800 tracking-tighter">$0 M</p>
      </div>
      <div class="p-8 rounded-[2.5rem] border shadow-sm bg-teal-50 border-teal-100">
        <p class="text-slate-500 text-[10px] font-black uppercase tracking-widest mb-1">Participaci√≥n INFIHUILA</p>
        <p id="statInfi" class="text-3xl font-black text-slate-800 tracking-tighter">$0 M</p>
      </div>
      <div class="p-8 rounded-[2.5rem] border shadow-sm bg-amber-50 border-amber-100">
        <p class="text-slate-500 text-[10px] font-black uppercase tracking-widest mb-1">Captaci√≥n Total</p>
        <p id="statCap" class="text-3xl font-black text-slate-800 tracking-tighter">$0 M</p>
      </div>
    </section>

    <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-slate-100">
        <h2 class="text-xl font-black text-slate-800 uppercase tracking-tighter">Comparativo del Mercado</h2>
        <p class="text-slate-400 text-[9px] font-bold uppercase tracking-widest mb-4">Instituciones seleccionadas</p>
        <canvas id="pieChart" height="320"></canvas>
      </div>

      <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-slate-100">
        <h2 class="text-xl font-black text-slate-800 uppercase tracking-tighter">Volumen Financiero</h2>
        <p class="text-slate-400 text-[9px] font-bold uppercase tracking-widest mb-4">Comparativa cr√©dito</p>
        <canvas id="barChart" height="320"></canvas>
      </div>

      <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-slate-100">
        <h2 class="text-xl font-black text-slate-800 uppercase tracking-tighter">Ranking Captaci√≥n</h2>
        <p id="rankSubtitle" class="text-slate-400 text-[9px] font-bold uppercase tracking-widest mb-4">Top municipios</p>
        <canvas id="rankChart" height="320"></canvas>
      </div>
    </section>

    <section class="bg-white rounded-[2.5rem] shadow-sm border border-slate-100 overflow-hidden">
      <div class="p-8 border-b border-slate-50 flex flex-col md:flex-row justify-between items-center gap-4 bg-slate-50/30">
        <div>
          <h2 class="text-xl font-black text-slate-800">Matriz de Acreedores</h2>
          <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1">Informaci√≥n tabulada por instituci√≥n</p>
        </div>
        <div class="px-4 py-2 bg-teal-50 text-teal-700 rounded-xl text-xs font-black uppercase tracking-widest border border-teal-100">
          <span id="resultsCount">0</span> Resultados
        </div>
      </div>

      <div class="overflow-x-auto">
        <table class="w-full text-left min-w-[1200px]">
          <thead id="tblHead"></thead>
          <tbody id="tblBody" class="divide-y divide-slate-50"></tbody>
        </table>
      </div>
    </section>

    <footer class="text-center text-xs text-slate-400 py-6">
      ¬© 2025 INFIHUILA - Instituto de Financiamiento, Promoci√≥n y Desarrollo del Huila Documento controlado. Cualquier impresi√≥n es copia no controlada.
    </footer>
  </main>

<script>
const INITIAL_DATA = [
  {
    "municipio": "ACEVEDO",
    "nit": "813002497:5",
    "entidad": "E.S.E. Hospital San Francisco Javier del Municipio de Acevedo",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 800,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ACEVEDO",
    "nit": "891180069:1",
    "entidad": "Acevedo",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ACEVEDO",
    "nit": "900250887:2",
    "entidad": "E.S.P. Empresas P√∫blicas de Acevedo S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "AGRADO",
    "nit": "891180147:8",
    "entidad": "E.S.E. Hospital San Antonio",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "AGRADO",
    "nit": "891180139:9",
    "entidad": "El Agrado",
    "colocacion": 1658,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 1862,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "AIPE",
    "nit": "891180238:1",
    "entidad": "E.S.E. Hospital San Carlos - Aipe",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "AIPE",
    "nit": "800078640:1",
    "entidad": "Qu√≠mica Integrada S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "AIPE",
    "nit": "891180070:1",
    "entidad": "Aipe",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "AIPE",
    "nit": "900252348:3",
    "entidad": "E.S.P. Empresas P√∫blicas de Aipe S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ALGECIRAS",
    "nit": "813001653:3",
    "entidad": "E.S.E. Hospital Luis Felipe Cabrera - Algeciras",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ALGECIRAS",
    "nit": "891180024:0",
    "entidad": "Algeciras",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 2363,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 250,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ALGECIRAS",
    "nit": "900263189:6",
    "entidad": "E.S.P. Empresas P√∫blicas de Algeciras S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ALTAMIRA",
    "nit": "891180118:4",
    "entidad": "Altamira",
    "colocacion": 0,
    "captacion": 94,
    "agrario": 438,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ALTAMIRA",
    "nit": "900305071:8",
    "entidad": "E.S.P. Servicios P√∫blicos Domiciliarios de Altamira S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "BARAYA",
    "nit": "891180159:6",
    "entidad": "E.S.E. Hospital Tulia Dur√°n de Borrero - Baraya",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "BARAYA",
    "nit": "891180183:3",
    "entidad": "Baraya",
    "colocacion": 0,
    "captacion": 15,
    "agrario": 299,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 2732,
    "findeter": 0
  },
  {
    "municipio": "BARAYA",
    "nit": "813013343:7",
    "entidad": "E.S.P. de Baraya",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "CAMPOALEGRE",
    "nit": "891180039:0",
    "entidad": "E.S.E. Hospital Nuestra Se√±ora del Rosario - Campoalegre",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "CAMPOALEGRE",
    "nit": "891118119:9",
    "entidad": "Campoalegre",
    "colocacion": 5303,
    "captacion": 269,
    "agrario": 2881,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "CAMPOALEGRE",
    "nit": "900168928:6",
    "entidad": "E.S.P. Servicios P√∫blicos de Campoalegre S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 412,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "CAMPOALEGRE",
    "nit": "900275841:2",
    "entidad": "Instituto Municipal de Tr√°nsito y Transporte de Campoalegre - Huila - En liquidaci√≥n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "CAMPOALEGRE",
    "nit": "901135647:3",
    "entidad": "Instituto de Tr√°nsito y Transporte de Campoalegre",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "COLOMBIA",
    "nit": "891180028:1",
    "entidad": "Colombia",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 1843,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "COLOMBIA",
    "nit": "813011706:8",
    "entidad": "E.S.E. Ana Silvia Maldonado Jim√©nez",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "COLOMBIA",
    "nit": "901254794:8",
    "entidad": "E.S.P. de Colombia Huila S.A.S.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ELIAS",
    "nit": "891180132:8",
    "entidad": "El√≠as",
    "colocacion": 1423,
    "captacion": 173,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ELIAS",
    "nit": "813011502:2",
    "entidad": "E.S.E. Hospital Municipal San Francisco de As√≠s - El√≠as",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ELIAS",
    "nit": "901542825:3",
    "entidad": "E.S.P. Espumas, Empresas P√∫blicas de El√≠as S.A.S.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "891180026:5",
    "entidad": "E.S.E. Hospital Departamental San Vicente de Paul - Garz√≥n",
    "colocacion": 400,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "891180022:6",
    "entidad": "Garz√≥n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 515,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 652,
    "occidente": 0,
    "popular": 0,
    "bbva": 16000,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "813002940:7",
    "entidad": "E.S.E. Mar√≠a Auxiliadora - Garz√≥n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "900010050:6",
    "entidad": "C.P.G.A Corpoagrocentro",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "891180074:9",
    "entidad": "Empresas P√∫blicas Municipales de Garz√≥n",
    "colocacion": 1999,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "901539311:9",
    "entidad": "Servicios Catastrales Nacionales Arga S.A.S.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 709,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "901555681:6",
    "entidad": "E.I.C.E. Empresa de Desarrollo Territorial Sostenible",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GIGANTE",
    "nit": "891180065:2",
    "entidad": "E.S.E. Hospital Gigante",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GIGANTE",
    "nit": "891180176:1",
    "entidad": "Gigante",
    "colocacion": 0,
    "captacion": 88,
    "agrario": 0,
    "bogota": 2564,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GIGANTE",
    "nit": "900256320:6",
    "entidad": "E.S.P. Empresas del Pueblo y para el Pueblo de Gigante S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GUADALUPE",
    "nit": "891180177:9",
    "entidad": "Guadalupe - Huila",
    "colocacion": 0,
    "captacion": 7,
    "agrario": 3990,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GUADALUPE",
    "nit": "813007875:9",
    "entidad": "E.S.E. Hospital Municipal Nuestra Se√±ora de Guadalupe",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GUADALUPE",
    "nit": "900331282:5",
    "entidad": "E.S.P. Empresa de Acueducto, Alcantarillado y Aseo de Guadalupe S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "HOBO",
    "nit": "891180019:3",
    "entidad": "Hobo",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 1694,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "HOBO",
    "nit": "813011515:8",
    "entidad": "E.S.E. Hospital Local Municipal de Hobo - Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "HOBO",
    "nit": "813009208:5",
    "entidad": "E.S.P. Emuserp Hobo - En Liquidaci√≥n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "HOBO",
    "nit": "900189880:1",
    "entidad": "E.S.P. Empresas P√∫blicas de Hobo S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "IQUIRA",
    "nit": "891103968:1",
    "entidad": "E.S.E. Hospital Mar√≠a Auxiliadora - √çquira",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "IQUIRA",
    "nit": "891180131:0",
    "entidad": "Iquira",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 669,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "IQUIRA",
    "nit": "900250076:6",
    "entidad": "E.S.P. Empresas P√∫blicas de √çquira S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ISNOS",
    "nit": "800097098:1",
    "entidad": "Isnos",
    "colocacion": 0,
    "captacion": 26,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 760,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ISNOS",
    "nit": "813010996:2",
    "entidad": "E.S.E. Hospital San Jos√© de Isnos",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "ISNOS",
    "nit": "900395462:9",
    "entidad": "E.S.P. Aguas y Aseo del Macizo S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA ARGENTINA",
    "nit": "891180205:7",
    "entidad": "La Argentina",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 1536,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA ARGENTINA",
    "nit": "813010966:1",
    "entidad": "E.S.E. Juan Ram√≥n N√∫√±ez Palacios - La Argentina",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA ARGENTINA",
    "nit": "900239471:8",
    "entidad": "E.S.P. Empresas P√∫blicas de la Argentina S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA PLATA",
    "nit": "891180117:7",
    "entidad": "E.S.E. Hospital Departamental San Antonio de Padua - La Plata",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA PLATA",
    "nit": "891180155:7",
    "entidad": "La Plata",
    "colocacion": 0,
    "captacion": 300,
    "agrario": 2991,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA PLATA",
    "nit": "813002872:4",
    "entidad": "E.S.E. San Sebastian del Municipio de La Plata - Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 791,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA PLATA",
    "nit": "830504349:1",
    "entidad": "Asociaci√≥n Agroempresarial de Municipios del Sur Occidente del Departamento del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "LA PLATA",
    "nit": "813002781:2",
    "entidad": "E.S.P. Empresa de Servicios P√∫blicos La Plata Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NATAGA",
    "nit": "891102844:0",
    "entidad": "N√°taga",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NATAGA",
    "nit": "813011465:8",
    "entidad": "E.S.E. Hospital Luis Antonio Mojica de N√°taga",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "891180084:2",
    "entidad": "Universidad Surcolombiana",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "891180001:1",
    "entidad": "E.S.P. Electrificadora del Huila S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800103913:4",
    "entidad": "Departamento del Huila",
    "colocacion": 2910,
    "captacion": 0,
    "agrario": 1542,
    "bogota": 17552,
    "davivienda": 3730,
    "bancolombia": 0,
    "occidente": 30763,
    "popular": 16388,
    "bbva": 0,
    "findeter": 24209
  },
  {
    "municipio": "NEIVA",
    "nit": "813005578:7",
    "entidad": "Instituto Departamental del Deporte y la Recreaci√≥n",
    "colocacion": 0,
    "captacion": 552,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "891180268:0",
    "entidad": "E.S.E. Hospital Departamental Hernando Moncaleano Perdomo - Neiva",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800236777:1",
    "entidad": "Fomcultura Fondo Mixto de Cultura y Turismo del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800244699:7",
    "entidad": "Empresa Loter√≠a y Juego de Apuestas Permanentes del Departamento del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800100553:2",
    "entidad": "Sociedad de Acueductos y Alcantarillados del Huila - Aguas del Huila S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 5,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "891180213:6",
    "entidad": "Instituto Financiero del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "891180009:1",
    "entidad": "Neiva",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 1098,
    "bancolombia": 57637,
    "occidente": 0,
    "popular": 0,
    "bbva": 29625,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "900028594:1",
    "entidad": "C.P.G.A. del Noroccidente del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "813005265:7",
    "entidad": "E.S.E. Carmen Emilia Ospina",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "900057486:6",
    "entidad": "C.P.G.A. del Centro Oriente del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "891180010:8",
    "entidad": "Empresas P√∫blicas Municipales de Neiva",
    "colocacion": 8860,
    "captacion": 0,
    "agrario": 0,
    "bogota": 847,
    "davivienda": 0,
    "bancolombia": 4472,
    "occidente": 258,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800255580:7",
    "entidad": "Corporaci√≥n Aut√≥noma Regional del Alto Magdalena",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "900125902:0",
    "entidad": "Empresa Forestal del Huila S.A.",
    "colocacion": 0,
    "captacion": 9346,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "900651344:6",
    "entidad": "Sistema Estrat√©gico de Transporte P√∫blico de Neiva S.A.S",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "900094866:9",
    "entidad": "Fondo de Vivienda de Inter√©s Social del Departamento del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800095147:3",
    "entidad": "Contralor√≠a Municipal de Neiva",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "800169790:9",
    "entidad": "Contralor√≠a Departamental del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "901489509:4",
    "entidad": "E.S.P. Empresa de Servicios de Iluminaci√≥n P√∫blica y Desarrollos Tecnol√≥gicos de Neiva S.A.S.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "101010101:0",
    "entidad": "Instituto Departamental de Acci√≥n Comunal del Departamento del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "OPORAPA",
    "nit": "891180179:3",
    "entidad": "Oporapa",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "OPORAPA",
    "nit": "813012946:3",
    "entidad": "E.S.E. Municipal David Molina Mu√±oz - Oporapa",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PAICOL",
    "nit": "891180194:4",
    "entidad": "Paicol",
    "colocacion": 0,
    "captacion": 289,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 1118,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PAICOL",
    "nit": "813011027:5",
    "entidad": "Empresa Social del Estado Santa Rosa de Lima de Paicol",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PALERMO",
    "nit": "891180091:4",
    "entidad": "E.S.E. Hospital San Francisco de As√≠s - Palermo",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PALERMO",
    "nit": "891180021:9",
    "entidad": "Palermo",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 13047,
    "bogota": 0,
    "davivienda": 109,
    "bancolombia": 1357,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PALERMO",
    "nit": "813002609:3",
    "entidad": "Empresa de Servicios P√∫blicos de Palermo",
    "colocacion": 189,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PALESTINA",
    "nit": "891102764:1",
    "entidad": "Palestina - Huila",
    "colocacion": 0,
    "captacion": 261,
    "agrario": 350,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PALESTINA",
    "nit": "813011505:4",
    "entidad": "E.S.E.Camilo Trujillo Silva - Palestina",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITAL",
    "nit": "891180199:0",
    "entidad": "El Pital",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 3038,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITAL",
    "nit": "813006877:9",
    "entidad": "E.S.E. Centro de Salud San Juan de Dios - El Pital",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "891180134:2",
    "entidad": "E.S.E. Hospital Departamental San Antonio - Pitalito",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "800130464:3",
    "entidad": "Terminal de Transportes de Pitalito S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "891180077:0",
    "entidad": "Pitalito",
    "colocacion": 229,
    "captacion": 0,
    "agrario": 5025,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "813005295:8",
    "entidad": "E.S.E. Manuel Castro Tovar - Pitalito",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "813013649:5",
    "entidad": "C.P.G.A. del Sur del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "800089312:8",
    "entidad": "Empresa de Servicios P√∫blicos de Pitalito",
    "colocacion": 6000,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "813001950:6",
    "entidad": "E.S.P. Biorg√°nicos del Sur del Huila S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "900522279:2",
    "entidad": "Instituto de Tr√°nsito y Transporte de Pitalito",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "900809150:5",
    "entidad": "Instituto de Cultura, Recreaci√≥n y Deporte del Municipio de Pitalito",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "PITALITO",
    "nit": "901253688:0",
    "entidad": "E.S.P. Sociedad de Econom√≠a Mixta Alumbrado P√∫blico de Pitalito S.A.S.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "RIVERA",
    "nit": "800115005:3",
    "entidad": "Instituto de Tr√°nsito y Transporte del Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "RIVERA",
    "nit": "891180040:9",
    "entidad": "Rivera",
    "colocacion": 3381,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "RIVERA",
    "nit": "813002933:5",
    "entidad": "E.S.E. Hospital Divino Ni√±o - Rivera",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "RIVERA",
    "nit": "813001390:1",
    "entidad": "Junta Municipal de Deportes y Recreaci√≥n de Rivera - Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "RIVERA",
    "nit": "900126216:0",
    "entidad": "E.S.P. Empresas P√∫blicas de Rivera S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SALADOBLANCO",
    "nit": "891180180:1",
    "entidad": "Saladoblanco",
    "colocacion": 14,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 698,
    "occidente": 2495,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SALADOBLANCO",
    "nit": "813012833:1",
    "entidad": "E.S.E. Nuestra Se√±ora de las Mercedes de Saladoblanco",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SALADOBLANCO",
    "nit": "900245329:4",
    "entidad": "E.S.P. Empresa de Acueducto, Alcantarillado y Aseo de Saladoblanco S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SAN AGUSTIN",
    "nit": "891180113:8",
    "entidad": "E.S.E. Hospital Arsenio Repizo Vanegas - San Agust√≠n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SAN AGUSTIN",
    "nit": "891180056:6",
    "entidad": "San Agust√≠n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 1378,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SAN AGUSTIN",
    "nit": "800094664:5",
    "entidad": "E.S.P. San Agust√≠n",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SANTA MARIA",
    "nit": "891180076:3",
    "entidad": "Santa Mar√≠a - Huila",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 687,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SANTA MARIA",
    "nit": "813010024:9",
    "entidad": "E.S.E. Nuestra Se√±ora del Carmen - Santa Mar√≠a",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SUAZA",
    "nit": "891180190:5",
    "entidad": "E.S.E. Hospital Nuestra Se√±ora de F√°tima - Suaza",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "SUAZA",
    "nit": "891180191:2",
    "entidad": "Suaza",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 1688,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 463,
    "occidente": 0,
    "popular": 0,
    "bbva": 385,
    "findeter": 0
  },
  {
    "municipio": "SUAZA",
    "nit": "900499642:5",
    "entidad": "E.S.P. Empresas P√∫blicas de Suaza S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TARQUI",
    "nit": "891180232:6",
    "entidad": "E.S.E. Hospital San Antonio - Tarqu√≠",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TARQUI",
    "nit": "891180211:1",
    "entidad": "T√°rqui",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 167,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 2720,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TELLO",
    "nit": "891180127:0",
    "entidad": "Tello",
    "colocacion": 1731,
    "captacion": 0,
    "agrario": 3158,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 1500,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TELLO",
    "nit": "813004018:1",
    "entidad": "E.S.E. Centro de Salud Miguel Barreto L√≥pez - Tello",
    "colocacion": 25,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TELLO",
    "nit": "900335153:1",
    "entidad": "Empresas P√∫blicas de Tello S.A.S. E.S.P.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TELLO",
    "nit": "101010101:0",
    "entidad": "Regi√≥n de Planeaci√≥n y Gesti√≥n - Ecoregi√≥n Tatacoa",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TERUEL",
    "nit": "891180181:9",
    "entidad": "Teruel",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 2769,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TERUEL",
    "nit": "813010472:5",
    "entidad": "E.S.E. Hospital San Roque",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TERUEL",
    "nit": "900171067:0",
    "entidad": "E.S.P. Empresas P√∫blicas de Teruel S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TESALIA",
    "nit": "891103889:6",
    "entidad": "E.S.E. Hospital Santa Teresa - Tesalia",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TESALIA",
    "nit": "800097176:6",
    "entidad": "Tesalia",
    "colocacion": 273,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 1391,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TESALIA",
    "nit": "900332875:7",
    "entidad": "E.S.P. Empresas P√∫blicas de Tesalia S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TIMANA",
    "nit": "891180198:3",
    "entidad": "E.S.E. Hospital San Antonio - Timan√°",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TIMANA",
    "nit": "891180182:6",
    "entidad": "Timan√°",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 2237,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 340,
    "occidente": 1600,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "TIMANA",
    "nit": "900330919:3",
    "entidad": "E.S.P. Empresas P√∫blicas de Timan√° S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "VILLAVIEJA",
    "nit": "891180187:2",
    "entidad": "Villavieja",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 1458,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "VILLAVIEJA",
    "nit": "813011566:3",
    "entidad": "E.S.E. Hospital del Perpetuo Socorro de Villavieja",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "VILLAVIEJA",
    "nit": "900377266:5",
    "entidad": "E.S.P Empresas Publicas de Villavieja S.A.S",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "YAGUARA",
    "nit": "800097180:6",
    "entidad": "Yaguar√°",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "YAGUARA",
    "nit": "813003431:4",
    "entidad": "E.S.E. Laura Perdomo de Garc√≠a",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "YAGUARA",
    "nit": "900250077:3",
    "entidad": "E.S.P. Empresas P√∫blicas de Yaguar√° S.A.",
    "colocacion": 0,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "",
    "entidad": "TERMINAL DE TRANSPORTES DE NEIVA",
    "colocacion": 375,
    "captacion": 1475,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "NEIVA",
    "nit": "",
    "entidad": "FOSFATOS DEL HUILA S.A.",
    "colocacion": 57,
    "captacion": 74,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "",
    "entidad": "ALIMENTOS CONCENTRADOS",
    "colocacion": 100,
    "captacion": 0,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  },
  {
    "municipio": "GARZON",
    "nit": "",
    "entidad": "TERMINAL DE TRANSPORTES DE GARZ√ìN",
    "colocacion": 0,
    "captacion": 116,
    "agrario": 0,
    "bogota": 0,
    "davivienda": 0,
    "bancolombia": 0,
    "occidente": 0,
    "popular": 0,
    "bbva": 0,
    "findeter": 0
  }
];

const BANKS = [
  { id: 'colocacion', label: 'INFIHUILA', color: '#0d9488' },
  { id: 'agrario', label: 'Bco Agrario', color: '#16a34a' },
  { id: 'bogota', label: 'Bco Bogot√°', color: '#ca8a04' },
  { id: 'davivienda', label: 'Davivienda', color: '#dc2626' },
  { id: 'bancolombia', label: 'Bancolombia', color: '#2563eb' },
  { id: 'occidente', label: 'Bco Occidente', color: '#4f46e5' },
  { id: 'popular', label: 'Bco Popular', color: '#9333ea' },
  { id: 'bbva', label: 'BBVA', color: '#0284c7' },
  { id: 'findeter', label: 'Findeter', color: '#be185d' }
];

let selectedBanks = new Set(BANKS.map(b => b.id));
let selectedMunicipio = "Todos";
let filterText = "";

const $ = (id) => document.getElementById(id);

function uniq(arr){ return [...new Set(arr)]; }
function fmt(n){ return Number(n||0).toLocaleString('es-CO'); }

function buildMunicipios(){
  const sel = $("selMunicipio");
  const munis = ["Todos", ...uniq(INITIAL_DATA.map(d=>d.municipio)).sort()];
  sel.innerHTML = munis.map(m => `<option value="${m}">${m === "Todos" ? "Todo el Departamento" : m}</option>`).join("");
  sel.value = selectedMunicipio;
}

function buildBanksMenu(){
  $("banksCount").textContent = selectedBanks.size;
  const wrap = $("banksList");
  wrap.innerHTML = BANKS.map(b => {
    const checked = selectedBanks.has(b.id);
    return `
      <button type="button" data-id="${b.id}" class="bank-item flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 transition-colors text-left group w-full">
        <span class="inline-flex items-center justify-center w-4 h-4 border border-slate-600 rounded ${checked ? "bg-teal-500 border-teal-500" : ""}"></span>
        <span class="text-xs font-medium ${checked ? "text-white" : "text-slate-400"}">${b.label}</span>
        <span class="ml-auto w-2 h-2 rounded-full" style="background:${b.color}"></span>
      </button>`;
  }).join("");

  wrap.querySelectorAll(".bank-item").forEach(btn => {
    btn.addEventListener("click", () => {
      const id = btn.getAttribute("data-id");
      if(selectedBanks.has(id)) selectedBanks.delete(id); else selectedBanks.add(id);
      buildBanksMenu();
      renderAll();
    });
  });
}

function getFiltered(){
  return INITIAL_DATA.filter(item => {
    const matchSearch = (item.entidad || "").toLowerCase().includes(filterText) || (item.municipio||"").toLowerCase().includes(filterText);
    const matchMunicipio = (selectedMunicipio === "Todos") || item.municipio === selectedMunicipio;
    return matchSearch && matchMunicipio;
  });
}

function computeBankTotals(filtered){
  const out = [];
  BANKS.forEach(b => {
    if(!selectedBanks.has(b.id)) return;
    const sum = filtered.reduce((acc, cur) => acc + (Number(cur[b.id])||0), 0);
    if(sum > 0) out.push({ name: b.label, value: sum, color: b.color, id: b.id });
  });
  out.sort((a,b)=>b.value-a.value);
  return out;
}

let pie, bar, rank;

function renderCharts(filtered){
  const totals = computeBankTotals(filtered);

  const totalCol = totals.reduce((s,i)=>s+i.value,0);
  const infi = totals.find(x=>x.id==="colocacion")?.value || 0;
  const cap = filtered.reduce((s,i)=>s+(Number(i.captacion)||0),0);
  $("statTotalCol").textContent = `$${fmt(totalCol)} M`;
  $("statInfi").textContent = `$${fmt(infi)} M`;
  $("statCap").textContent = `$${fmt(cap)} M`;

  // ‚úÖ PIE/DOUGHNUT con % de participaci√≥n en el tooltip
  const pieCtx = $("pieChart").getContext("2d");
  if(pie) pie.destroy();
  pie = new Chart(pieCtx, {
    type: "doughnut",
    data: {
      labels: totals.map(t => t.name),
      datasets: [{
        data: totals.map(t => t.value),
        backgroundColor: totals.map(t => t.color)
      }]
    },
    options: {
      cutout: "60%",
      plugins: {
        legend: { position: "bottom" },
        tooltip: {
          callbacks: {
            label: function (context) {
              const value = context.raw || 0;
              const total = context.dataset.data.reduce((a, b) => a + b, 0);
              const percent = total ? ((value / total) * 100).toFixed(2) : 0;
              return ` ${context.label}: $${Number(value).toLocaleString('es-CO')} M (${percent}%)`;
            }
          }
        }
      }
    }
  });

  const barCtx = $("barChart").getContext("2d");
  if(bar) bar.destroy();
  bar = new Chart(barCtx, {
    type: "bar",
    data: {
      labels: totals.map(t=>t.name),
      datasets: [{ label: "Colocaci√≥n (M)", data: totals.map(t=>t.value), backgroundColor: totals.map(t=>t.color) }]
    },
    options: { plugins: { legend: { display: false } }, scales: { x: { ticks: { maxRotation: 60, minRotation: 0 } } } }
  });

  const rankData = (() => {
    if(selectedMunicipio === "Todos"){
      const grouped = {};
      for(const r of filtered){
        grouped[r.municipio] = (grouped[r.municipio]||0) + (Number(r.captacion)||0);
      }
      return Object.entries(grouped).map(([name,value])=>({name,value})).filter(x=>x.value>0).sort((a,b)=>b.value-a.value).slice(0,10);
    } else {
      return filtered
        .map(r=>({name: r.entidad.length>20 ? r.entidad.slice(0,20)+"‚Ä¶" : r.entidad, value: Number(r.captacion)||0}))
        .filter(x=>x.value>0).sort((a,b)=>b.value-a.value).slice(0,10);
    }
  })();

  $("rankSubtitle").textContent = (selectedMunicipio==="Todos") ? "Top municipios (Activos)" : "Top entidades local";

  const rankCtx = $("rankChart").getContext("2d");
  if(rank) rank.destroy();
  rank = new Chart(rankCtx, {
    type: "bar",
    data: { labels: rankData.map(x=>x.name), datasets: [{ label: "Captaci√≥n (M)", data: rankData.map(x=>x.value) }] },
    options: { plugins: { legend: { display: false } }, scales: { x: { ticks: { maxRotation: 60, minRotation: 0 } } } }
  });
}

function renderTable(filtered){
  $("resultsCount").textContent = filtered.length;

  const headCols = [];
  headCols.push(`<th class="px-6 py-5 sticky left-0 bg-slate-50 z-10">Entidad / Municipio</th>`);
  if(selectedBanks.has("colocacion")){
    headCols.push(`<th class="px-6 py-5 text-center bg-teal-50 text-teal-700 font-black">INFI COLOCACI√ìN</th>`);
    headCols.push(`<th class="px-6 py-5 text-center bg-teal-50 text-teal-700 font-black">INFI CAPTACI√ìN</th>`);
  }
  for(const b of BANKS.slice(1)){
    if(selectedBanks.has(b.id)){
      headCols.push(`<th class="px-4 py-5 text-center uppercase text-[9px] tracking-widest text-slate-500">${b.label}</th>`);
    }
  }
  $("tblHead").innerHTML = `<tr class="bg-slate-50 border-b border-slate-100 text-[9px] uppercase font-bold tracking-widest">${headCols.join("")}</tr>`;

  const rows = filtered.map(item => {
    const cells = [];
    cells.push(`
      <td class="px-6 py-5 sticky left-0 bg-white group-hover:bg-slate-50 z-10">
        <div class="text-[11px] font-black text-slate-800 uppercase tracking-tighter truncate max-w-[280px]">${item.entidad}</div>
        <div class="text-[10px] font-bold text-teal-600 uppercase">${item.municipio}</div>
        <div class="text-[9px] text-slate-400 font-mono">NIT: ${item.nit}</div>
      </td>`);

    if(selectedBanks.has("colocacion")){
      cells.push(`<td class="px-6 py-5 text-center text-xs font-black bg-teal-50/10 text-teal-700">${(item.colocacion>0)?`$${fmt(item.colocacion)}`:"-"}</td>`);
      cells.push(`<td class="px-6 py-5 text-center text-xs font-black bg-teal-50/10 text-amber-600">${(item.captacion>0)?`$${fmt(item.captacion)}`:"-"}</td>`);
    }

    for(const b of BANKS.slice(1)){
      if(!selectedBanks.has(b.id)) continue;
      const v = Number(item[b.id])||0;
      cells.push(`<td class="px-4 py-5 text-center"><span class="text-[11px] font-bold ${v>0?"":"text-slate-300"}" style="${v>0?`color:${b.color}`:""}">${v>0?`$${fmt(v)}`:"-"}</span></td>`);
    }

    return `<tr class="group hover:bg-slate-50 transition-all">${cells.join("")}</tr>`;
  });
  $("tblBody").innerHTML = rows.join("");
}

function renderAll(){
  const filtered = getFiltered();
  renderCharts(filtered);
  renderTable(filtered);
}

function downloadCSV(){
  const filtered = getFiltered();
  const headers = ["Municipio","NIT","Entidad","INFIHUILA Colocaci√≥n","INFIHUILA Captaci√≥n","Banco Agrario","Banco de Bogot√°","Davivienda","Bancolombia","Banco de Occidente","Banco Popular","BBVA","Findeter"];
  const rows = filtered.map(i => [
    i.municipio, i.nit, String(i.entidad).replace(/;/g, ","),
    i.colocacion, i.captacion, i.agrario, i.bogota, i.davivienda, i.bancolombia, i.occidente, i.popular, i.bbva, i.findeter
  ]);
  const csv = "\uFEFF" + [headers.join(";"), ...rows.map(r=>r.join(";"))].join("\n");
  const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `Matriz_Financiera_${selectedMunicipio.replace(/\s/g,"_")}.csv`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

// UI wiring
$("btnBanks").addEventListener("click", ()=>{
  $("banksMenu").classList.toggle("hidden");
});

document.addEventListener("click", (e)=>{
  const menu = $("banksMenu");
  const btn = $("btnBanks");
  if(menu.classList.contains("hidden")) return;
  if(menu.contains(e.target) || btn.contains(e.target)) return;
  menu.classList.add("hidden");
});

$("btnToggleAll").addEventListener("click", ()=>{
  if(selectedBanks.size === BANKS.length){
    selectedBanks = new Set(); $("btnToggleAll").textContent = "Todos";
  } else {
    selectedBanks = new Set(BANKS.map(b=>b.id)); $("btnToggleAll").textContent = "Ninguno";
  }
  buildBanksMenu();
  renderAll();
});

$("selMunicipio").addEventListener("change", (e)=>{ selectedMunicipio = e.target.value; renderAll(); });
$("txtSearch").addEventListener("input", (e)=>{ filterText = e.target.value.trim().toLowerCase(); renderAll(); });

$("btnReset").addEventListener("click", ()=>{
  selectedBanks = new Set(BANKS.map(b=>b.id));
  selectedMunicipio = "Todos";
  filterText = "";
  $("txtSearch").value = "";
  $("selMunicipio").value = "Todos";
  buildBanksMenu();
  renderAll();
});

$("btnExcel").addEventListener("click", downloadCSV);

// init
buildMunicipios();
buildBanksMenu();
renderAll();
</script>

</body>
</html>
